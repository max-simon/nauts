[
  {
    "id": "admin",
    "name": "Admin Policy",
    "statements": [
      {
        "effect": "allow",
        "actions": ["nats.*", "js.*", "kv.*"],
        "resources": ["nats:>", "js:*", "kv:*"]
      }
    ]
  },
  {
    "id": "writer",
    "name": "Writer Policy",
    "statements": [
      {
        "effect": "allow",
        "actions": ["nats.pub"],
        "resources": ["nats:public.>"]
      },
      {
        "effect": "allow",
        "actions": ["js.manage"],
        "resources": ["js:STREAM_WRITE"]
      },
      {
        "effect": "allow",
        "actions": ["kv.edit"],
        "resources": ["kv:BUCKET_WRITE"]
      }
    ]
  },
  {
    "id": "reader",
    "name": "Reader Policy",
    "statements": [
      {
        "effect": "allow",
        "actions": ["nats.sub"],
        "resources": ["nats:public.>"]
      },
      {
        "effect": "allow",
        "actions": ["js.view"],
        "resources": ["js:STREAM_WRITE"]
      },
      {
        "effect": "allow",
        "actions": ["js.consume"],
        "resources": ["js:STREAM_READ:CONSUMER_READ"]
      },
      {
        "effect": "allow",
        "actions": ["kv.view"],
        "resources": ["kv:BUCKET_WRITE"]
      },
      {
        "effect": "allow",
        "actions": ["kv.read"],
        "resources": ["kv:BUCKET_READ"]
      }
    ]
  },
  {
    "id": "service",
    "name": "Service Policy",
    "statements": [
      {
        "effect": "allow",
        "actions": ["nats.service"],
        "resources": ["nats:service.>"]
      }
    ]
  },
  {
    "id": "user-vars",
    "name": "User Variables Policy",
    "statements": [
      {
        "effect": "allow",
        "actions": ["nats.pub", "nats.sub"],
        "resources": ["nats:user.{{user.id}}.>"]
      },
      {
        "effect": "allow",
        "actions": ["kv.edit"],
        "resources": ["kv:USER_{{user.id}}"]
      },
      {
        "effect": "allow",
        "actions": ["js.consume"],
        "resources": ["js:STREAM_VARS:{{user.id}}"]
      }
    ]
  }
]
